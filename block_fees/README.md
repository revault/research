# Historical block fees harvester

A small program fetching historical metadata (with an emphasis on fees) from block files using
[Riccardo Casatta's `blocks_iterator`](https://github.com/RCasatta/blocks_iterator).

Run by specifying the path to your `blk***.dat` and a network:
```
cargo run --release -- --blocks-dir ~/.bitcoin/blocks/ --network bitcoin
```

This will write to a [`historical_fees.csv`](historical_fees.csv) file the following data:
```
Block height, Block hash, Difficulty, Block Weight, Mean fee, Median fee, Min fee, Max fee, Mean fee, Median fee, Min fee, Max fee, Block time (as human readable date)
```

This excludes the coinbase transaction for fees data, and will print `NA` instead when there is no
other transaction than the coinbase in the block:
```
$ tail historical_fees.csv
659519,0000000000000000000e40529fb23a76b1d5ca537ba585a5b89aaec9808b52e0,19157154724710,3992267,43474,24308,2260,7265953,30,28,2,166
659520,00000000000000000009b8f1506aed2ea69d104f5fcbe49e5612a82dcec45a69,19157154724710,3998294,43357,25000,590,2466949,30,29,0,474
659521,0000000000000000000a1bd340aad625ea0da8d14f7d5613be0954a34b3f2d0f,19157154724710,3992214,59627,22630,374,9337603,27,25,0,99
659522,0000000000000000000292d7d7533174956e296349477d8aacadba45e5881c29,19157154724710,3998322,43931,22374,1122,7430789,25,25,0,112
659523,0000000000000000000e3766bb6f38003f3536b92deea91566be012505d3fdae,19157154724710,3997235,45512,26833,3674,3406017,32,30,5,517
659524,00000000000000000008ded4dd8d51e4dea5541491241a412cc1fed07f30ac45,19157154724710,3998027,39779,24408,908,2533994,28,27,1,376
659525,0000000000000000000b81295c61135c2d98fd996352f59fb908a850e6b01dfc,19157154724710,3998032,41527,24182,840,4173424,29,27,1,223
659526,0000000000000000000463f23bb8b6a847b2ded1c80e732bcc72ec4048655aad,19157154724710,3998260,76916,21338,744,3432665,24,24,0,64
659527,00000000000000000000d7322ac1e0b71a9e97b1e25545562a06de4f673f14b4,19157154724710,3991973,50629,29154,1764,7004340,37,33,2,250
659528,0000000000000000000b329a72dbe87c2534cb848ddd731b5c7bf9a2e47339a0,19157154724710,3992325,51247,25312,226,10000000,30,29,0,375
$ head historical_fees.csv
0,000000000019d6689c085ae165831e934ff763ae46a2a6c172b3f1b60a8ce26f,1,324,NA,NA,NA,NA,NA,NA,NA,NA
1,00000000839a8e6886ab5951d76f411475428afc90947ee320161bbf18eb6048,1,324,NA,NA,NA,NA,NA,NA,NA,NA
2,000000006a625f06636b8bb6ac7b960a8d03705d1ace08b1a19da3fdcc99ddbd,1,324,NA,NA,NA,NA,NA,NA,NA,NA
3,0000000082b5015589a3fdf2d4baff403e6f0be035a5d9742c1cae6295464449,1,324,NA,NA,NA,NA,NA,NA,NA,NA
4,000000004ebadb55ee9096c9a2f8880e09da59c0d68b1c228da88e48844a1485,1,324,NA,NA,NA,NA,NA,NA,NA,NA
5,000000009b7262315dbf071787ad3656097b892abffd1f95a1a022f896f533fc,1,324,NA,NA,NA,NA,NA,NA,NA,NA
6,000000003031a0e73735690c5a1ff2a4be82553b2a12b776fbd3a215dc8f778d,1,324,NA,NA,NA,NA,NA,NA,NA,NA
7,0000000071966c2b1d065fd446b1e485b2c9d9594acd2007ccbd5441cfc89444,1,324,NA,NA,NA,NA,NA,NA,NA,NA
8,00000000408c48f847aa786c2268fc3e6ec2af68e8468a34a28c61b7f1de0dc6,1,324,NA,NA,NA,NA,NA,NA,NA,NA
9,000000008d9dc510f23c2657fc4f67bea30078cc05a90eb89e84cc475c080805,1,324,NA,NA,NA,NA,NA,NA,NA,NA
```
